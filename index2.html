<html>
<head>

	<script src="https://sapui5.hana.ondemand.com/resources/sap-ui-core.js"
		data-sap-ui-libs="sap.m,sap.ui.vbm"
		data-sap-ui-theme="sap_belize"
		data-sap-ui-xx-bindingSyntax="complex" >
	</script>
<style>
#vbi {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
}
</style>
</head>

<body><div id="map" /><script>
var oModel = new sap.ui.model.json.JSONModel();
var oModel2 = new sap.ui.model.xml.XMLModel();
oModel2.loadData("panos/picasaalbum.xml");
oModel2.setNameSpace("http://www.w3.org/2005/Atom");
oModel2.setNameSpace("http://www.georss.org/georss", "georss");
oModel2.setNameSpace("http://www.opengis.net/gml", "gml");
oModel2.setNameSpace("http://search.yahoo.com/mrss/", "media");

/*var jqxhr = $.ajax( "panos/picasaalbum.xml" )
  .done(function(data) {
   // oModel2.setData(data);
  })
  .fail(function() {
    alert( "error" );
  })
  .always(function() {
    alert( "complete" );
  });

$.getJSON("panos/images.json", function(data) {
	    oModel.setData(data);
	});*/
	var oVBI = new sap.ui.vbm.GeoMap('vbi', {
	    width: "100%",
	    height: "100%",
	    centerPosition: "174.6305342;-36.8618248",
	    zoomlevel: 10,
	    vos: [
	        new sap.ui.vbm.Spots({
	            items: {
	                path: "/entry",
	                template: new sap.ui.vbm.Spot({
	                    labelText: '{title}',
	                    image: {
	                    	path:"media:group/media:thumbnail/0/@url", 
	                    	formatter : function (data) {
	                    		var name = data.substring(data.lastIndexOf("/"), data.length);
	                    		oVBI.addResource(new sap.ui.vbm.Resource({
	                    			name: name, 
	                    			src: data//.replace("https", "http")
	                    		}));
	                    		return name;
		                    }
		                },
	                    position: {
	                    	path:"georss:where/gml:Point/gml:pos", 
	                    	formatter : function (data) {
	                    		return data.split(" ")[1]+";"+data.split(" ")[0]+";0.0";
		                    }
		                },
	                    click : function (oEv) {
	                    	document.location.href="panorama.html?img="+oEv.getSource().getBindingContext().getProperty("content/@src");
	                    }
	                })
	            }
	        })
	    ]
	});
	oVBI.setModel(oModel2);
	var setMapConfiguration = ({
	    "MapProvider": [{
	        "name": "OSM",
	        "type": "",
	        "description": "",
	        "tileX": "256",
	        "tileY": "256",
	        "maxLOD": "20",
	        "copyright": "openstreetmap.org (c)",
	        "Source": [{
	            "id": "s1",
	            "url": "//a.tile.openstreetmap.org/{LOD}/{X}/{Y}.png"
	        }, {
	            "id": "s2",
	            "url": "//b.tile.openstreetmap.org/{LOD}/{X}/{Y}.png"
	        }, {
	            "id": "s3",
	            "url": "//c.tile.openstreetmap.org/{LOD}/{X}/{Y}.png"
	        }]
	    }, ],
	    "MapLayerStacks": [{
	        "name": "Default",
	        "MapLayer": {
	            "name": "layer1",
	            "refMapProvider": "OSM",
	            "opacity": "1.0",
	            "colBkgnd": "RGB(255,255,255)"
	        }
	    }]
	});
	oVBI.setMapConfiguration(setMapConfiguration);
	oVBI.placeAt("map");</script></body>
	</html>